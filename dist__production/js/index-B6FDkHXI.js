const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index-DgrHEvt0.js","js/pinia-CTGgt2hX.js","js/vue-demi-Dq6ymT-8.js","js/@vue-5amejw8K.js","js/index-D30c5w24.js","js/vue-router-Bq7HluqB.js","js/js-cookie-BXEMiIsG.js","js/@element-plus-YR8FD5Tz.js","js/nprogress-CwwpQnHY.js","js/@intlify-KwFOTgoq.js","css/nprogress.CSXic_Zd.css","js/axios-XtWrBBVz.js","js/qs-d0NUDaEV.js","js/side-channel-ABGcfzWN.js","js/get-intrinsic-Dcwdwnz4.js","js/es-errors-Bza6HHKb.js","js/has-symbols-BjfDv0FJ.js","js/has-proto-DxUgyt-t.js","js/function-bind-Ckw9YnhN.js","js/hasown-DTGZhiFA.js","js/call-bind-COXgxIYc.js","js/set-function-length-CYeVTiyi.js","js/define-data-property-DvIQPL4R.js","js/es-define-property-DwRRhIwF.js","js/gopd-CVOMcQVD.js","js/has-property-descriptors-CDOEcoVi.js","js/object-inspect-Da024_OR.js","js/element-plus-AyclcJdL.js","js/lodash-es-EFZEm3Z2.js","js/@vueuse-DWSxN83p.js","js/@popperjs-CpAfbxx4.js","js/@ctrl-D2oWfImC.js","js/dayjs-BeASU03D.js","js/async-validator-Cuo4gI4y.js","js/memoize-one-Ds0C_khL.js","js/normalize-wheel-es-Vn5vHDCm.js","js/@floating-ui-DT7V1Oc1.js","js/vue-i18n-agluwRAO.js","js/vue-CBwmpGZq.js","js/mitt-CNZ6avp8.js","js/vue-grid-layout-WvDAhvPt.js","css/index.BVvPMfFH.css","css/tailwindcss.B_OxdTrg.css","css/index.CfaxiRuQ.css","js/index-V-jKEAKn.js","css/index.DMjCbxRC.css","js/index-2YoS29lk.js","js/help-CKE1DKIN.js"])))=>i.map(i=>d[i]);
import{a as e,u as o,b as n,_ as t}from"./index-D30c5w24.js";import{d as i,b as l,_ as a,j as s,Z as r,c as d,S as c,a as p,V as u,u as m,P as f,F as b,a9 as j,n as h,ai as w,o as g,K as k,U as y,J as v,a3 as x,aU as I}from"./@vue-5amejw8K.js";import{j as L}from"./jsplumb-Bp-UOLtz.js";import{S as D}from"./sortablejs-brRwdIwn.js";import{s as P}from"./pinia-CTGgt2hX.js";import{c as E}from"./commonFunction-Du_c6hhY.js";import{a as _,E as C}from"./element-plus-AyclcJdL.js";import"./vue-router-Bq7HluqB.js";import"./js-cookie-BXEMiIsG.js";import"./@element-plus-YR8FD5Tz.js";import"./nprogress-CwwpQnHY.js";import"./@intlify-KwFOTgoq.js";import"./axios-XtWrBBVz.js";import"./qs-d0NUDaEV.js";import"./side-channel-ABGcfzWN.js";import"./get-intrinsic-Dcwdwnz4.js";import"./es-errors-Bza6HHKb.js";import"./has-symbols-BjfDv0FJ.js";import"./has-proto-DxUgyt-t.js";import"./function-bind-Ckw9YnhN.js";import"./hasown-DTGZhiFA.js";import"./call-bind-COXgxIYc.js";import"./set-function-length-CYeVTiyi.js";import"./define-data-property-DvIQPL4R.js";import"./es-define-property-DwRRhIwF.js";import"./gopd-CVOMcQVD.js";import"./has-property-descriptors-CDOEcoVi.js";import"./object-inspect-Da024_OR.js";import"./vue-i18n-agluwRAO.js";import"./vue-CBwmpGZq.js";import"./mitt-CNZ6avp8.js";import"./vue-grid-layout-WvDAhvPt.js";/* empty css                    */import"./vue-demi-Dq6ymT-8.js";import"./lodash-es-EFZEm3Z2.js";import"./@vueuse-DWSxN83p.js";import"./@popperjs-CpAfbxx4.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-BeASU03D.js";import"./async-validator-Cuo4gI4y.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-DT7V1Oc1.js";import"./vue-clipboard3-B2mWbtZg.js";import"./clipboard-DnJJ02Ih.js";import"./formatTime-V_I984Ws.js";const S=[{title:"工作流",icon:"iconfont icon-shouye",isOpen:!0,id:"1",children:[{icon:"iconfont icon-gongju",name:"引擎",id:"11",form:[{type:"input",label:"客户姓名",prop:"name",placeholder:"请输入客户姓名",required:!0,disabled:!1},{type:"select",label:"性别",prop:"sex",placeholder:"请选择性别",required:!0,disabled:!1,options:[{value:"0",label:"女"},{value:"1",label:"男"}]},{type:"input",label:"员工编号",prop:"number",placeholder:"请输入员工编号",required:!0,disabled:!1},{type:"input",label:"办公电话",prop:"mobile",placeholder:"请输入办公电话",required:!0,disabled:!1},{type:"select",label:"权限分配",prop:"role",placeholder:"请选择性别",required:!0,disabled:!1,options:[{value:"0",label:"编辑权限"},{value:"1",label:"删除权限"}]},{type:"checkbox",label:"模块选择",prop:"module",placeholder:"请选择模块",required:!0,disabled:!1}]},{icon:"iconfont icon-shouye_dongtaihui",name:"模版",id:"12",form:[{type:"input",label:"等级",prop:"grade",placeholder:"请输入等级",required:!0,disabled:!1},{type:"input",label:"登记密码",prop:"password",placeholder:"请输入登记密码",required:!0,disabled:!1}]},{icon:"iconfont icon-zhongduancanshuchaxun",name:"名称",id:"13",form:[{type:"input",label:"数据表",prop:"dataSheet",placeholder:"请输入数据表",required:!0,disabled:!1},{type:"input",label:"字段配置",prop:"field",placeholder:"请输入字段配置",required:!0,disabled:!1}]},{icon:"iconfont icon-zhongduancanshu",name:"版本",id:"14",form:[{type:"input",label:"发布模板",prop:"publish",placeholder:"请输入发布模板",required:!0,disabled:!1}]},{icon:"iconfont icon-bolangnengshiyanchang",name:"建模",id:"15",form:[{type:"input",label:"内容模板",prop:"content",placeholder:"请输入内容模板",required:!0,disabled:!1}]},{icon:"iconfont icon-xingqiu",name:"节点",id:"16",form:[{type:"input",label:"活动名称6",prop:"name16"}]}]},{title:"流程",isOpen:!0,icon:"iconfont icon-caijian",id:"2",children:[{icon:"iconfont icon-fuwenben",name:"实例",id:"21",form:[{type:"input",label:"活动名称7",prop:"name21"}]},{icon:"iconfont icon-fuwenbenkuang",name:"轨迹",id:"22",form:[{type:"input",label:"活动名称8",prop:"name22"}]},{icon:"iconfont icon-shangchuan",name:"数据",id:"23",form:[{type:"input",label:"活动名称9",prop:"name23"}]}]},{title:"任务",isOpen:!0,icon:"iconfont icon-shuju",id:"3",children:[{icon:"iconfont icon-icon-",name:"参与人",id:"31",form:[{type:"input",label:"活动名称1",prop:"name31"}]},{icon:"iconfont icon-gerenzhongxin",name:"执行人",id:"32",form:[{type:"input",label:"活动名称2",prop:"name32"}]},{icon:"iconfont icon-fangkuang",name:"工单",id:"33",form:[{type:"input",label:"活动名称3",prop:"name33"}]}]}],T={Anchors:["Top","TopCenter","TopRight","TopLeft","Right","RightMiddle","Bottom","BottomCenter","BottomRight","BottomLeft","Left","LeftMiddle"],Container:"workflow-right",Connector:["Bezier",{curviness:100}],ConnectionsDetachable:!1,DeleteEndpointsOnDetach:!1,Endpoint:["Blank",{Overlays:""}],EndpointStyle:{fill:"#1879ffa1",outlineWidth:1},LogEnabled:!0,PaintStyle:{stroke:"#E0E3E7",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},DragOptions:{cursor:"pointer",zIndex:2e3},Overlays:[["Arrow",{width:10,length:8,location:1,direction:1,foldback:.623}],["Label",{label:"",location:.5,cssClass:"aLabel"}]],RenderMode:"svg",HoverPaintStyle:{stroke:"#b0b2b5",strokeWidth:1},EndpointHoverStyle:{fill:"red"},Scope:"jsPlumb_DefaultScope"},N={filter:".workflow-icon-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!0,maxConnections:-1},O={filter:".workflow-icon-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!0,dropOptions:{hoverClass:"ef-drop-hover"}},R={isSource:!0,isTarget:!0,anchor:"Continuous"},z={class:"workflow-container layout-padding"},q={key:0,class:"workflow-mask"},A={class:"layout-padding-auto layout-padding-view workflow-warp"},M={class:"workflow"},B={class:"workflow-content"},$={class:"workflow-left"},V=["onClick"],W=["data-name","data-icon","data-id"],X={class:"workflow-left-item-icon"},F={class:"font10 pl5 name"},J=["id","data-node-id","onClick","onContextmenu"],U={class:"workflow-left-item-icon"},Y={class:"font10 pl5 name"},H=t(i({__name:"index",setup(t){const i=I((()=>n((()=>import("./index-DgrHEvt0.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43])))),H=I((()=>n((()=>import("./index-V-jKEAKn.js")),__vite__mapDeps([44,3,4,1,2,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,45])))),K=I((()=>n((()=>import("./index-2YoS29lk.js")),__vite__mapDeps([46,4,3,1,2,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42])))),G=I((()=>n((()=>import("./help-CKE1DKIN.js")),__vite__mapDeps([47,3])))),Q=l([]),Z=l(),ee=l(),oe=l(),ne=l(),te=l(),ie=e(),le=o(),{themeConfig:ae}=P(le),{copyText:se}=E(),re=a({leftNavList:[],dropdownNode:{x:"",y:""},dropdownLine:{x:"",y:""},isShow:!1,jsPlumb:null,jsPlumbNodeIndex:null,jsplumbDefaults:T,jsplumbMakeSource:N,jsplumbMakeTarget:O,jsplumbConnect:R,jsplumbData:{nodeList:[],lineList:[]}}),de=()=>{const e=document.body.clientWidth;re.isShow=e<768},ce=()=>{re.jsplumbData.nodeList.forEach((e=>{re.jsPlumb.makeSource(e.nodeId,re.jsplumbMakeSource),re.jsPlumb.makeTarget(e.nodeId,re.jsplumbMakeTarget,R),re.jsPlumb.draggable(e.nodeId,{containment:"parent",stop:e=>{re.jsplumbData.nodeList.forEach((o=>{o.nodeId===e.el.id&&(o.left=`${e.pos[0]}px`,o.top=`${e.pos[1]}px`)}))}})})),re.jsplumbData.lineList.forEach((e=>{re.jsPlumb.connect({source:e.sourceId,target:e.targetId,label:e.label},re.jsplumbConnect)}))},pe=e=>{const{contextMenuClickId:o,nodeId:n}=e;if(0===o){const e=re.jsplumbData.nodeList.findIndex((e=>e.nodeId===n));re.jsplumbData.nodeList.splice(e,1),re.jsPlumb.removeAllEndpoints(n),re.jsPlumbNodeIndex=null}else 1===o&&ne.value.open(e)},ue=(e,o)=>{const{contextMenuClickId:n}=e,{endpoints:t}=o,i=[];t.forEach((e=>{i.push({id:e.element.id,innerText:e.element.innerText})})),e.contact=`${i[0].innerText}(${i[0].id}) => ${i[1].innerText}(${i[1].id})`,0===n?re.jsPlumb.deleteConnection(o):1===n&&ne.value.open(e,o)},me=e=>{const{sourceId:o,targetId:n,label:t}=e,i=re.jsPlumb.getConnections({source:o,target:n})[0];i.setLabel(t),t&&""!==t?(i.removeClass("workflow-right-empty-label"),i.addClass("workflow-right-label")):i.addClass("workflow-right-empty-label"),re.jsplumbData.lineList.forEach((e=>{e.sourceId===o&&e.targetId===n&&(e.label=t)}))},fe=e=>{const{nodeId:o,name:n,icon:t}=e;re.jsplumbData.nodeList.forEach((e=>{e.nodeId===o&&(e.name=n,e.icon=t)})),h((()=>{re.jsPlumb.setSuspendDrawing(!1,!0)}))},be=e=>{switch(e){case"help":je();break;case"download":he();break;case"submit":we();break;case"copy":ge();break;case"del":ke();break;case"fullscreen":ye()}},je=()=>{h((()=>{te.value.open()}))},he=()=>{const{globalTitle:e}=ae.value,o="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(re.jsplumbData,null,"\t")),n=document.createElement("a");n.setAttribute("href",o),n.setAttribute("download",`${e}工作流.json`),n.click(),n.remove(),_.success("下载成功")},we=()=>{_.success("数据提交成功")},ge=()=>{se(JSON.stringify(re.jsplumbData))},ke=()=>{C.confirm("此操作将清空画布，是否继续？","提示",{confirmButtonText:"清空",cancelButtonText:"取消"}).then((()=>{re.jsplumbData.nodeList.forEach((e=>{re.jsPlumb.removeAllEndpoints(e.nodeId)})),h((()=>{re.jsplumbData={nodeList:[],lineList:[]},_.success("清空画布成功")}))})).catch((()=>{}))},ye=()=>{ie.setCurrenFullscreen(!0)};return s((async()=>{await(re.leftNavList=S,void(re.jsplumbData={nodeList:[{nodeId:"huej738hbji",left:"148px",top:"93px",class:"workflow-right-clone",icon:"iconfont icon-gongju",name:"引擎",id:"11"},{nodeId:"52kcszzyxrd",left:"458px",top:"203px",class:"workflow-right-clone",icon:"iconfont icon-shouye_dongtaihui",name:"模版",id:"12"},{nodeId:"nltskl6k4me",left:"164px",top:"350px",class:"workflow-right-clone",icon:"iconfont icon-zhongduancanshuchaxun",name:"名称",id:"13"}],lineList:[{sourceId:"huej738hbji",targetId:"52kcszzyxrd",label:"传送"},{sourceId:"huej738hbji",targetId:"nltskl6k4me",label:""}]})),Q.value.forEach((e=>{D.create(e,{group:{name:"vue-next-admin-1",pull:"clone",put:!1},animation:0,sort:!1,draggable:".workflow-left-item",forceFallback:!0,onEnd:function(e){const{name:o,icon:n,id:t}=e.clone.dataset,{layerX:i,layerY:l,clientX:a,clientY:s}=e.originalEvent,r=Z.value,{x:d,y:c,width:p,height:u}=r.getBoundingClientRect();if(a<d||a>p+d||s<c||c>c+u)_.warning("请把节点拖入到画布中");else{const e=Math.random().toString(36).substr(2,12),a={nodeId:e,left:i-40+"px",top:l-15+"px",class:"workflow-right-clone",name:o,icon:n,id:t};re.jsplumbData.nodeList.push(a),h((()=>{re.jsPlumb.makeSource(e,re.jsplumbMakeSource),re.jsPlumb.makeTarget(e,re.jsplumbMakeTarget,R),re.jsPlumb.draggable(e,{containment:"parent",stop:e=>{re.jsplumbData.nodeList.forEach((o=>{o.nodeId===e.el.id&&(o.left=`${e.pos[0]}px`,o.top=`${e.pos[1]}px`)}))}})}))}}})})),L.jsPlumb.ready((()=>{re.jsPlumb=L.jsPlumb.getInstance({detachable:!1,Container:"workflow-right"}),re.jsPlumb.fire("jsPlumbDemoLoaded",re.jsPlumb),re.jsPlumb.importDefaults(re.jsplumbDefaults),re.jsPlumb.setSuspendDrawing(!1,!0),ce(),re.jsPlumb.bind("contextmenu",((e,o)=>{o.preventDefault();const{sourceId:n,targetId:t}=e,{clientX:i,clientY:l}=o;re.dropdownLine.x=i,re.dropdownLine.y=l;const a=re.jsplumbData.nodeList.find((e=>e.nodeId===t)),s=re.jsplumbData.lineList.find((e=>e.sourceId===n&&e.targetId===t));a.type="line",a.label=s.label,oe.value.openContextmenu(a,e)})),re.jsPlumb.bind("beforeDrop",(e=>{const{sourceId:o,targetId:n}=e;return!re.jsplumbData.lineList.find((e=>e.sourceId===o&&e.targetId===n))||(_.warning("关系已存在，不可重复连接"),!1)})),re.jsPlumb.bind("connection",(e=>{const{sourceId:o,targetId:n}=e;re.jsplumbData.lineList.push({sourceId:o,targetId:n,label:""})})),re.jsPlumb.bind("connectionDetached",(e=>{const{sourceId:o,targetId:n}=e;re.jsplumbData.lineList=re.jsplumbData.lineList.filter((e=>e.sourceId!=o||e.targetId!=n))}))})),de(),window.addEventListener("resize",de)})),r((()=>{window.removeEventListener("resize",de)})),(e,o)=>{const n=w("SvgIcon"),t=w("el-scrollbar");return g(),d("div",z,[re.isShow?(g(),d("div",q)):c("",!0),p("div",A,[p("div",M,[u(m(i),{onTool:be}),p("div",B,[p("div",$,[u(t,null,{default:f((()=>[(g(!0),d(b,null,j(re.leftNavList,(e=>(g(),d("div",{ref_for:!0,ref_key:"leftNavRefs",ref:Q,key:e.id,style:k({height:e.isOpen?"auto":"50px",overflow:"hidden"}),class:"workflow-left-id"},[p("div",{class:"workflow-left-title",onClick:o=>(e=>{e.isOpen=!e.isOpen})(e)},[p("span",null,y(e.title),1),u(n,{name:e.isOpen?"ele-ArrowDown":"ele-ArrowRight"},null,8,["name"])],8,V),(g(!0),d(b,null,j(e.children,((e,o)=>(g(),d("div",{class:"workflow-left-item",key:o,"data-name":e.name,"data-icon":e.icon,"data-id":e.id},[p("div",X,[u(n,{name:e.icon,class:"workflow-icon-drag"},null,8,["name"]),p("div",F,y(e.name),1)])],8,W)))),128))],4)))),128))])),_:1})]),p("div",{class:"workflow-right",ref_key:"workflowRightRef",ref:Z},[(g(!0),d(b,null,j(re.jsplumbData.nodeList,((e,o)=>(g(),d("div",{key:e.nodeId,id:e.nodeId,"data-node-id":e.nodeId,class:v(e.class),style:k({left:e.left,top:e.top}),onClick:e=>(e=>{re.jsPlumbNodeIndex=e})(o),onContextmenu:x((n=>((e,o,n)=>{re.jsPlumbNodeIndex=o;const{clientX:t,clientY:i}=n;re.dropdownNode.x=t,re.dropdownNode.y=i,e.type="node",e.label="";let l={};re.leftNavList.forEach((o=>{o.children&&o.children.find((o=>o.id===e.id))&&(l=o.children.find((o=>o.id===e.id)))})),e.from=l.form,ee.value.openContextmenu(e)})(e,o,n)),["prevent"])},[p("div",{class:v(["workflow-right-box",{"workflow-right-active":re.jsPlumbNodeIndex===o}])},[p("div",U,[u(n,{name:e.icon,class:"workflow-icon-drag"},null,8,["name"]),p("div",Y,y(e.name),1)])],2)],46,J)))),128))],512)])])]),u(m(H),{dropdown:re.dropdownNode,ref_key:"contextmenuNodeRef",ref:ee,onCurrent:pe},null,8,["dropdown"]),u(m(H),{dropdown:re.dropdownLine,ref_key:"contextmenuLineRef",ref:oe,onCurrent:ue},null,8,["dropdown"]),u(m(K),{ref_key:"drawerRef",ref:ne,onLabel:me,onNode:fe},null,512),u(m(G),{ref_key:"helpRef",ref:te},null,512)])}}}),[["__scopeId","data-v-dd42d50a"]]);export{H as default};
